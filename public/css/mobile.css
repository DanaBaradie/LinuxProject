/**
 * Comprehensive Mobile Responsive Styles
 * 
 * Ensures the application works perfectly on mobile and tablet devices
 * 
 * @author Dana Baradie
 * @course IT404
 */

/* =====================================================
   MOBILE FIX: REMOVE SIDEBAR OFFSET & CENTER CONTENT
   ===================================================== */

@media (max-width: 768px) {

    /* 1. Kill sidebar-induced layout offset at ROOT level */
    body {
        margin-left: 0 !important;
        left: 0 !important;
        transform: none !important;
        overflow-x: hidden;
        padding-top: 0 !important;
        /* Spacing handled by content areas */
    }

    /* 2. Reset ALL common app layout wrappers */
    .app,
    .app-layout,
    .layout,
    .dashboard-layout,
    .dashboard-container,
    .dashboard-wrapper,
    .content,
    .content-wrapper,
    .page-content,
    .main,
    main,
    .main-content,
    .main-content-area {
        margin-left: 0 !important;
        left: 0 !important;
        transform: none !important;
        width: 100% !important;
        max-width: 100% !important;
        padding-left: 15px !important;
        padding-right: 15px !important;
        padding-top: 160px !important;
        /* Maximum spacing from navbar on mobile (56px navbar + 104px extra for optimal mobile viewing) */
    }

    /* 3. Collapse grid/flex layouts that include sidebar */
    .app-layout,
    .layout,
    .dashboard-layout {
        display: block !important;
        grid-template-columns: 1fr !important;
    }

    /* 4. Ensure rows do NOT reintroduce horizontal shift */
    .row {
        margin-left: 0 !important;
        margin-right: 0 !important;
        width: 100%;
    }

    /* 5. Cards must be visually centered */
    .card,
    .stat-card,
    .widget {
        margin-left: auto !important;
        margin-right: auto !important;
        width: 100% !important;
        margin-bottom: 1rem;
    }

    /* 6. Consistent spacing below fixed navbar */
    .main-content,
    .main-content-area,
    main.col-md-9,
    main.col-lg-10 {
        padding-top: 160px !important;
        /* Maximum spacing from navbar on mobile (56px navbar + 104px extra for optimal mobile viewing) */
        padding-left: 15px !important;
        padding-right: 15px !important;
    }

    /* 7. Sidebar mobile behavior */
    .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        z-index: 1030;
        position: fixed !important;
        top: 56px !important;
        left: 0 !important;
        height: calc(100vh - 56px) !important;
    }

    .sidebar.show {
        transform: translateX(0) !important;
    }

    .sidebar-overlay {
        display: none;
        position: fixed;
        top: 56px;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1029;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
    }

    .sidebar-overlay.show {
        display: block !important;
    }

    /* 8. Navbar adjustments */
    .navbar {
        padding: 0.5rem 1rem;
    }

    .navbar-brand {
        font-size: 1rem;
    }

    .navbar .text-white {
        font-size: 0.875rem;
    }

    /* Sidebar toggle button - ensure it's clickable */
    #sidebarToggle {
        min-width: 44px !important;
        min-height: 44px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        z-index: 1040 !important;
        cursor: pointer !important;
        -webkit-tap-highlight-color: rgba(255, 255, 255, 0.3);
    }

    #sidebarToggle:active {
        opacity: 0.7;
    }

    /* 9. Force full-width containers */
    .container,
    .container-fluid {
        max-width: 100% !important;
        width: 100% !important;
        margin-left: 0 !important;
        margin-right: 0 !important;
        padding-left: 15px !important;
        padding-right: 15px !important;
    }

    /* 10. Dashboard columns stack on mobile */
    .row>[class*="col-"] {
        margin-left: 0 !important;
        margin-right: 0 !important;
        float: none !important;
        width: 100% !important;
        margin-bottom: 1rem;
    }

    /* 11. Tables become scrollable on mobile */
    .table-responsive {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }

    .table {
        font-size: 0.875rem;
    }

    .table th,
    .table td {
        padding: 0.5rem;
        white-space: nowrap;
    }

    /* 12. Buttons full width on mobile for better touch targets */
    .btn {
        min-height: 44px; /* iOS recommended touch target */
        padding: 0.625rem 1rem;
        font-size: 1rem;
    }

    .btn-sm {
        min-height: 36px;
        padding: 0.5rem 0.75rem;
    }

    /* 13. Form inputs larger for mobile */
    .form-control,
    .form-select {
        min-height: 44px;
        font-size: 16px; /* Prevents zoom on iOS */
        padding: 0.75rem;
    }

    /* 14. Cards padding adjustment */
    .card-body {
        padding: 1rem;
    }

    .card-header {
        padding: 0.75rem 1rem;
        font-size: 0.95rem;
    }

    /* Ensure colored card headers maintain their colors on mobile */
    .card-header.bg-primary,
    .card-header.bg-success,
    .card-header.bg-info,
    .card-header.bg-danger {
        background-color: var(--bs-primary) !important;
        color: white !important;
        border-bottom: none !important;
    }

    .card-header.bg-primary h5,
    .card-header.bg-success h5,
    .card-header.bg-info h5,
    .card-header.bg-danger h5 {
        color: white !important;
    }

    .card-header.bg-info {
        background-color: var(--bs-info) !important;
    }

    .card-header.bg-warning:not(.text-white) {
        background-color: var(--bs-warning) !important;
        color: #212529 !important;
        border-bottom: none !important;
    }

    .card-header.bg-warning:not(.text-white) h5 {
        color: #212529 !important;
    }

    .card-header.bg-warning.text-dark {
        background-color: var(--bs-warning) !important;
        color: #212529 !important;
        border-bottom: none !important;
    }

    .card-header.bg-warning.text-dark h5 {
        color: #212529 !important;
    }

    /* 15. Stats cards stack */
    .grid-responsive {
        grid-template-columns: 1fr !important;
        gap: 1rem;
    }

    /* 16. Page headers */
    .d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center {
        flex-direction: column;
        align-items: flex-start !important;
        gap: 1rem;
    }

    .d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center .btn-toolbar {
        width: 100%;
    }

    /* 17. Map containers */
    .map-container {
        height: 400px !important;
        width: 100%;
    }

    /* 18. Badges and labels */
    .badge {
        font-size: 0.75rem;
        padding: 0.35rem 0.65rem;
    }

    /* 19. Alerts */
    .alert {
        padding: 0.75rem 1rem;
        font-size: 0.9rem;
    }

    /* 20. Hide less important elements on mobile */
    .d-none.d-md-inline-block {
        display: none !important;
    }

    /* 21. Quick actions buttons stack */
    .quick-action-btn-clear {
        margin-bottom: 0.75rem;
    }

    /* 22. Stats horizontal layout becomes vertical */
    .quick-stats-horizontal {
        flex-direction: column;
    }

    /* 23. Modal adjustments */
    .modal-dialog {
        margin: 0.5rem;
        max-width: calc(100% - 1rem);
    }

    .modal-content {
        border-radius: 0.5rem;
    }

    /* Date picker modal on mobile */
    #customDateModal {
        z-index: 1055 !important;
    }

    #customDateModal .modal-dialog {
        margin: 0.5rem;
        max-width: calc(100% - 1rem);
    }

    #customDateModal .modal-body {
        padding: 1rem;
    }

    #customDateModal .form-label {
        font-size: 0.95rem;
        margin-bottom: 0.5rem;
    }

    #customDateModal input[type="date"] {
        font-size: 16px; /* Prevents zoom on iOS */
        min-height: 44px;
    }

    #customDateModal .btn-group {
        flex-direction: column;
        width: 100%;
    }

    #customDateModal .btn-group .btn {
        width: 100%;
        margin-bottom: 0.5rem;
        min-height: 44px;
    }

    #customDateModal .btn-group .btn:last-child {
        margin-bottom: 0;
    }

    #customDateModal .modal-footer {
        flex-direction: column;
    }

    #customDateModal .modal-footer .btn {
        width: 100%;
        margin-bottom: 0.5rem;
        min-height: 44px;
    }

    #customDateModal .modal-footer .btn:last-child {
        margin-bottom: 0;
    }

    /* Ensure modal backdrop is visible */
    .modal-backdrop {
        z-index: 1040 !important;
    }

    /* Dropdown adjustments */
    .dropdown-menu {
        max-width: 90vw;
        font-size: 0.95rem;
    }

    .btn-group .dropdown-toggle {
        min-width: 120px;
        min-height: 44px;
        font-size: 0.9rem;
    }

    .btn-group .btn {
        min-height: 44px;
        padding: 0.625rem 1rem;
    }

    /* Date filter button group */
    .btn-toolbar .btn-group {
        width: 100%;
        margin-bottom: 0.5rem;
    }

    .btn-toolbar .btn-group .btn {
        flex: 1;
    }

    /* 24. Navigation improvements */
    .sidebar .nav-link {
        padding: 12px 20px;
        font-size: 1rem;
    }

    /* 25. Text adjustments */
    h1 {
        font-size: 1.75rem;
    }

    h2 {
        font-size: 1.5rem;
    }

    h3 {
        font-size: 1.25rem;
    }

    h4 {
        font-size: 1.1rem;
    }

    h5 {
        font-size: 1rem;
    }

    /* 26. Spacing adjustments */
    .mb-4 {
        margin-bottom: 1.5rem !important;
    }

    .mb-5 {
        margin-bottom: 2rem !important;
    }

    .pt-3 {
        padding-top: 1rem !important;
    }

    .pb-2 {
        padding-bottom: 0.5rem !important;
    }

}

/* =====================================================
   TABLET STYLES (768px - 992px)
   ===================================================== */

@media (min-width: 769px) and (max-width: 992px) {
    .sidebar {
        width: 200px;
    }

    main.main-content-area,
    .main-content-area {
        margin-left: 200px !important;
        width: calc(100% - 200px) !important;
        padding-left: 30px !important;
    }

    .grid-responsive {
        grid-template-columns: repeat(2, 1fr);
    }

    .map-container {
        height: 500px;
    }
}

/* =====================================================
   LARGE MOBILE / SMALL TABLET (576px - 768px)
   ===================================================== */

@media (min-width: 576px) and (max-width: 768px) {
    .container-fluid {
        padding-left: 20px !important;
        padding-right: 20px !important;
    }

    .card-body {
        padding: 1.25rem;
    }
}

/* =====================================================
   EXTRA SMALL MOBILE (< 576px)
   ===================================================== */

@media (max-width: 575px) {
    .container-fluid {
        padding-left: 10px !important;
        padding-right: 10px !important;
    }

    .card-body {
        padding: 0.75rem;
    }

    .btn {
        width: 100%;
        margin-bottom: 0.5rem;
    }

    .btn-group {
        flex-direction: column;
        width: 100%;
    }

    .btn-group .btn {
        border-radius: 0.375rem !important;
        margin-bottom: 0.5rem;
    }

    .table {
        font-size: 0.8rem;
    }

    .table th,
    .table td {
        padding: 0.375rem;
    }

    h1 {
        font-size: 1.5rem;
    }

    h2 {
        font-size: 1.25rem;
    }

    .stats-card-modern .stat-value {
        font-size: 2rem;
    }

    .stats-card-modern .stat-icon {
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
    }
}

/* =====================================================
   LANDSCAPE MOBILE ORIENTATION
   ===================================================== */

@media (max-width: 768px) and (orientation: landscape) {
    .map-container {
        height: 300px;
    }

    .sidebar {
        width: 220px;
    }
}

/* =====================================================
   TOUCH DEVICE OPTIMIZATIONS
   ===================================================== */

@media (hover: none) and (pointer: coarse) {
    /* Touch device specific styles */
    .btn,
    .nav-link,
    .card {
        -webkit-tap-highlight-color: rgba(13, 110, 253, 0.2);
    }

    .btn:active,
    .nav-link:active {
        transform: scale(0.98);
    }

    /* Larger touch targets */
    .nav-link {
        min-height: 44px;
        display: flex;
        align-items: center;
    }

    /* Prevent text selection on buttons */
    .btn {
        -webkit-user-select: none;
        user-select: none;
    }
}